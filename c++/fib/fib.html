<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>test wasm</title>
    </head>
    <body>
        <input type="number" id="fib_param" value="0">
        <br/>
        <button id="add" name="button">计算</button>
        <p >
            结果: <span id="result"></span>
        </p>

        <script type="text/javascript">
            var Module = {};
            fetch('fib.wasm').then(response => response.arrayBuffer())
            .then((bytes) => {
                Module.wasmBinary = bytes;
                var script = document.createElement('script');
                script.src = "fib.js";
                document.body.appendChild(script);
            });
            const resultEl = document.getElementById('result')

            document.getElementById('add').addEventListener('click', () => {
                var fibParam = document.getElementById('fib_param').value;
                var result = Module.ccall('fib', 'number', ['number'], [fibParam]);
                resultEl.innerText = result
            })
        </script>
    </body>
</html>